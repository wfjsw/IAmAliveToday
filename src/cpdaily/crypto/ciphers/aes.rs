use openssl::error::ErrorStack;

use openssl::symm::{decrypt as cipher_decrypt, encrypt as cipher_encrypt, Cipher};

pub fn encrypt(plaintext: &[u8], key: &[u8], iv: &[u8]) -> Result<Vec<u8>, ErrorStack> {
    let cipher = Cipher::aes_128_cbc();
    cipher_encrypt(cipher, key, Some(iv), plaintext)
}

pub fn decrypt(ciphertext: &[u8], key: &[u8], iv: &[u8]) -> Result<Vec<u8>, ErrorStack> {
    let cipher = Cipher::aes_128_cbc();
    cipher_decrypt(cipher, key, Some(iv), ciphertext)
}

pub fn getak(key: &str, hk: &str) -> String {
    let mut out = String::with_capacity(key.len() + hk.len());
    for i in (0..key.len()).step_by(2) {
        out.push(key.chars().nth(i).unwrap());
    }
    for i in (0..hk.len()).step_by(2) {
        out.push(hk.chars().nth(i).unwrap());
    }
    for i in (1..key.len()).step_by(2) {
        out.push(key.chars().nth(i).unwrap());
    }
    for i in (1..hk.len()).step_by(2) {
        out.push(hk.chars().nth(i).unwrap());
    }
    out
}

#[cfg(test)]
mod tests {
    use crate::cpdaily::crypto::ciphers::aes::{decrypt, encrypt, getak};
    use crate::cpdaily::crypto::ciphers::base64::decode;

    #[test]
    fn test_getak() {
        assert_eq!("ytUQ7l2ZZu8mLvJZ", getak("yZtuU8Qm", "7Llv2JZZ"));
        assert_eq!("CCtO7fm4NygoC7yF", getak("CNCytgOo", "7Cf7my4F"))
    }

    #[test]
    fn test_aes() {
        let key = b"ytUQ7l2ZZu8mLvJZ";
        let iv = b"\x01\x02\x03\x04\x05\x06\x07\x08\x09\x01\x02\x03\x04\x05\x06\x07";
        let clear_text = r#"{"formWid":"2467","address":"山东省青岛市市北区宜昌路38号","collectWid":"38465","instanceWid":null,"schoolTaskWid":"183142","form":[{"wid":"62377","formWid":"2467","fieldType":"7","title":"今天你的所在地是？","description":"国内请选择省/市/区（县）；海外请选择海外/州/国家","isRequired":true,"hasOtherItems":false,"sort":1,"colName":"field001","fieldItems":[],"scoringRule":"-1","score":null,"answerContent":null,"basicConfig":{"minValue":null,"maxValue":null,"decimals":null,"dateFormatType":null,"dateType":null,"pointTime":null,"minTime":null,"maxTime":null,"extremeLabel":null,"level":null,"isReversal":null,"leftValue":null,"rightValue":null,"voteType":null,"voteMinValue":null,"voteMaxValue":null},"logicWid":1,"value":"山东省/青岛市/市北区","show":true,"formType":"0","sortNum":"1"},{"wid":"62378","formWid":"2467","fieldType":"2","title":"今天你的体温是多少？","description":"","isRequired":true,"hasOtherItems":false,"sort":2,"colName":"field002","fieldItems":[{"itemWid":"182833","content":"37.2℃及以下","imageUrl":"","isOtherItems":false,"contentExtend":"","otherItemType":"1","basicConfig":null,"showLogic":"","showLogicArray":null,"isAnswer":false,"score":null,"isSelected":1,"selectCount":null,"totalCount":0}],"scoringRule":"-1","score":null,"answerContent":null,"basicConfig":{"minValue":null,"maxValue":null,"decimals":null,"dateFormatType":null,"dateType":null,"pointTime":null,"minTime":null,"maxTime":null,"extremeLabel":null,"level":null,"isReversal":null,"leftValue":null,"rightValue":null,"voteType":null,"voteMinValue":null,"voteMaxValue":null},"logicWid":2,"value":"","show":true,"formType":"0","sortNum":"2"},{"wid":"62379","formWid":"2467","fieldType":"2","title":"今天你的身体状况是？","description":"","isRequired":true,"hasOtherItems":true,"sort":3,"colName":"field003","fieldItems":[{"itemWid":"182836","content":"健康","imageUrl":"","isOtherItems":false,"contentExtend":"","otherItemType":"1","basicConfig":null,"showLogic":"","showLogicArray":null,"isAnswer":false,"score":null,"isSelected":1,"selectCount":null,"totalCount":0}],"scoringRule":"-1","score":null,"answerContent":null,"basicConfig":{"minValue":null,"maxValue":null,"decimals":null,"dateFormatType":null,"dateType":null,"pointTime":null,"minTime":null,"maxTime":null,"extremeLabel":null,"level":null,"isReversal":null,"leftValue":null,"rightValue":null,"voteType":null,"voteMinValue":null,"voteMaxValue":null},"logicWid":3,"value":"","show":true,"formType":"0","sortNum":"3"},{"wid":"62380","formWid":"2467","fieldType":"2","title":"近14天你或你的共同居住人是否有疫情中、高风险区域人员接触史？","description":"","isRequired":true,"hasOtherItems":false,"sort":4,"colName":"field004","fieldItems":[{"itemWid":"182842","content":"否","imageUrl":"","isOtherItems":false,"contentExtend":"","otherItemType":"1","basicConfig":null,"showLogic":"","showLogicArray":null,"isAnswer":false,"score":null,"isSelected":1,"selectCount":null,"totalCount":0}],"scoringRule":"-1","score":null,"answerContent":null,"basicConfig":{"minValue":null,"maxValue":null,"decimals":null,"dateFormatType":null,"dateType":null,"pointTime":null,"minTime":null,"maxTime":null,"extremeLabel":null,"level":null,"isReversal":null,"leftValue":null,"rightValue":null,"voteType":null,"voteMinValue":null,"voteMaxValue":null},"logicWid":4,"value":"","show":true,"formType":"0","sortNum":"4"},{"wid":"62381","formWid":"2467","fieldType":"2","title":"近14天你或你的共同居住人是否和确诊、疑似病人接触过？","description":"","isRequired":true,"hasOtherItems":false,"sort":5,"colName":"field005","fieldItems":[{"itemWid":"182844","content":"否","imageUrl":"","isOtherItems":false,"contentExtend":"","otherItemType":"1","basicConfig":null,"showLogic":"","showLogicArray":null,"isAnswer":false,"score":null,"isSelected":1,"selectCount":null,"totalCount":0}],"scoringRule":"-1","score":null,"answerContent":null,"basicConfig":{"minValue":null,"maxValue":null,"decimals":null,"dateFormatType":null,"dateType":null,"pointTime":null,"minTime":null,"maxTime":null,"extremeLabel":null,"level":null,"isReversal":null,"leftValue":null,"rightValue":null,"voteType":null,"voteMinValue":null,"voteMaxValue":null},"logicWid":5,"value":"","show":true,"formType":"0","sortNum":"5"},{"wid":"62382","formWid":"2467","fieldType":"2","title":"近14天你或你的共同居住人是否是确诊、疑似病例？","description":"","isRequired":true,"hasOtherItems":false,"sort":6,"colName":"field006","fieldItems":[{"itemWid":"182846","content":"否","imageUrl":"","isOtherItems":false,"contentExtend":"","otherItemType":"1","basicConfig":null,"showLogic":"","showLogicArray":null,"isAnswer":false,"score":null,"isSelected":1,"selectCount":null,"totalCount":0}],"scoringRule":"-1","score":null,"answerContent":null,"basicConfig":{"minValue":null,"maxValue":null,"decimals":null,"dateFormatType":null,"dateType":null,"pointTime":null,"minTime":null,"maxTime":null,"extremeLabel":null,"level":null,"isReversal":null,"leftValue":null,"rightValue":null,"voteType":null,"voteMinValue":null,"voteMaxValue":null},"logicWid":6,"value":"","show":true,"formType":"0","sortNum":"6"},{"wid":"62383","formWid":"2467","fieldType":"2","title":"你或你的共同居住人目前是否被医学隔离？","description":"这里指的隔离是指：由社区、街道或当地政府、医院认定要求的。","isRequired":true,"hasOtherItems":false,"sort":7,"colName":"field007","fieldItems":[{"itemWid":"182848","content":"否","imageUrl":"","isOtherItems":false,"contentExtend":"","otherItemType":"1","basicConfig":null,"showLogic":"","showLogicArray":null,"isAnswer":false,"score":null,"isSelected":1,"selectCount":null,"totalCount":0}],"scoringRule":"-1","score":null,"answerContent":null,"basicConfig":{"minValue":null,"maxValue":null,"decimals":null,"dateFormatType":null,"dateType":null,"pointTime":null,"minTime":null,"maxTime":null,"extremeLabel":null,"level":null,"isReversal":null,"leftValue":null,"rightValue":null,"voteType":null,"voteMinValue":null,"voteMaxValue":null},"logicWid":7,"value":"","show":true,"formType":"0","sortNum":"7"},{"wid":"62384","formWid":"2467","fieldType":"2","title":"今天你当地的健康码颜色是？","description":"","isRequired":true,"hasOtherItems":false,"sort":8,"colName":"field008","fieldItems":[{"itemWid":"182849","content":"绿色","imageUrl":"","isOtherItems":false,"contentExtend":"","otherItemType":"1","basicConfig":null,"showLogic":"","showLogicArray":null,"isAnswer":false,"score":null,"isSelected":1,"selectCount":null,"totalCount":0}],"scoringRule":"-1","score":null,"answerContent":null,"basicConfig":{"minValue":null,"maxValue":null,"decimals":null,"dateFormatType":null,"dateType":null,"pointTime":null,"minTime":null,"maxTime":null,"extremeLabel":null,"level":null,"isReversal":null,"leftValue":null,"rightValue":null,"voteType":null,"voteMinValue":null,"voteMaxValue":null},"logicWid":8,"value":"","show":true,"formType":"0","sortNum":"8"},{"wid":"62385","formWid":"2467","fieldType":"2","title":"本人是否承诺以上所填报的全部内容均属实、准确，不存在任何隐瞒与不实的情况，更无遗漏之处","description":"","isRequired":true,"hasOtherItems":false,"sort":9,"colName":"field009","fieldItems":[{"itemWid":"182852","content":"是","imageUrl":"","isOtherItems":false,"contentExtend":"","otherItemType":"1","basicConfig":null,"showLogic":"","showLogicArray":null,"isAnswer":false,"score":null,"isSelected":1,"selectCount":null,"totalCount":0}],"scoringRule":"-1","score":null,"answerContent":null,"basicConfig":{"minValue":null,"maxValue":null,"decimals":null,"dateFormatType":null,"dateType":null,"pointTime":null,"minTime":null,"maxTime":null,"extremeLabel":null,"level":null,"isReversal":null,"leftValue":null,"rightValue":null,"voteType":null,"voteMinValue":null,"voteMaxValue":null},"logicWid":9,"value":"","show":true,"formType":"0","sortNum":"9"}],"uaIsCpadaily":true,"latitude":36.123921,"longitude":120.352463}"#;
        let cipher_text = decode("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 WNd0ARfKx7CezdzoeujwgPIuBkNj0/8sZA==").unwrap();

        assert_eq!(
            clear_text.as_bytes().to_owned(),
            decrypt(&cipher_text, key, iv).unwrap()
        );
        assert_eq!(
            cipher_text,
            encrypt(clear_text.as_bytes(), key, iv).unwrap()
        );
    }
}
